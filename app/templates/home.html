{% extends 'header.html' %} {% block content %}
<main>
    <h1 class="text-center">Buscador de personajes de Los Simpsons</h1>

    <div class="d-flex justify-content-center" style="margin-bottom: 1%">
        <!-- Buscador del sitio -->
        <form class="d-flex" action="{% url 'buscar' %}" method="POST">
            {% csrf_token %}
            <input class="form-control me-2" type="search" name="query" placeholder="Homer, Marge, Bart, Lisa..." aria-label="Search">
            <button class="btn btn-outline-success" type="submit">Buscar</button>
        </form>
    </div>

    <div class="d-flex gap-1 col-2 mx-auto mb-3">
        <form method="post" action="{% url 'filter_by_status' %}">
            {% csrf_token %}
            <input type="hidden" name="status" value="Alive">
            <button type="submit" class="btn btn-success">Vivos</button>
        </form>

        <form method="post" action="{% url 'filter_by_status' %}">
            {% csrf_token %}
            <input type="hidden" name="status" value="Deceased">
            <button type="submit" class="btn btn-secondary">Fallecidos</button>
        </form>
    </div>

   
<div class="row row-cols-1 row-cols-md-3 g-4">

  <!-- Si no hay imagenes, muestra un mensaje -->
  {% if images|length == 0 %}
    <div class="col-12">
      <h2 class="text-center">La bÃºsqueda no arrojÃ³ resultados...</h2>
    </div>
  {% else %}

    <!-- Recorre cada personaje de la lista de imagenes -->
    {% for img in images %}
      <div class="col">
            <!-- Card de cada personaje, el borde cambia segÃºn el estado del personaje -->
            <div class="card h-100 shadow-sm
                {% if img.status == 'Alive' %}
                    border-success
                {% elif img.status == 'Deceased' %}
                    border-secondary
                {% else %}
                    border-warning
                {% endif %}
            ">
            <div class="row g-0">

            <!-- Imagen -->
            <div class="col-md-4 d-flex align-items-center justify-content-center p-2">
              <img src="{{ img.image }}"
                   class="img-fluid rounded-circle"
                   alt="{{ img.name }}">
            </div>

            <!-- Contenido -->
            <div class="col-md-8">
              <div class="card-body">
                <h5 class="card-title text-center">{{ img.name }}</h5>
                <!-- Frase aleatoria del personaje, si no hay frases muestra un mensaje vacÃ­o -->
                <div class="alert alert-warning p-2 text-center">
                    {% if img.phrases %}
                        "{{ img.phrases|random }}"
                    {% else %}
                        ""
                    {% endif %}
                </div>

                <p class="card-text"><small class="text-body-secondary">ğŸ‘¤ GÃ©nero: {{ img.gender }}</small></p>
                {% if img.age %}
                <p class="card-text"><small class="text-body-secondary">ğŸ‚ Edad: {{ img.age }} aÃ±os</small></p>
                {% endif %}
                <p class="card-text"><small class="text-body-secondary">{% if img.status == 'Alive' %}ğŸŸ¢{% elif img.status == 'Deceased' %}âš«{% else %}â“{% endif %} Estado: {{ img.status }}</small></p>
                <p class="card-text"><small class="text-body-secondary">ğŸ’¼ OcupaciÃ³n: {{ img.occupation }}</small></p>

              </div>
            </div>

          </div>
        </div>
      </div>
    {% endfor %}

  {% endif %}

</div>
</main>
{% endblock %}